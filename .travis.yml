language: node_js
node_js:
  - "9.7.1"
install: npm install
script: gatsby build
deploy:
  provider: script
  script: npm install -g scottyjs && mkdir ~/.aws && echo $"[default]\naws_access_key_id=$AWS_ACCESS_KEY_ID\naws_secret_access_key=$AWS_SECRET_ACCESS_KEY" >~/.aws/credentials && scotty --source ./public --bucket exposeless --spa --nocdn --update --website --profile default
  skip_cleanup: true
cache:
  directories:
    - "node_modules"
    - ".cache"
